{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/blog/why-is-polymorphism-important/",
    "result": {"data":{"site":{"siteMetadata":{"title":"wasabigeek"}},"markdownRemark":{"id":"b69f0811-eeb7-567d-afea-d7aee3d4da38","excerpt":"When I first came across the concept of Polymorphism in Object-Oriented Programming (OOP), it wasn’t obvious to me why it was important. The top search results…","html":"<p>When I first came across the concept of Polymorphism in Object-Oriented Programming (OOP), it wasn’t obvious to me <em>why</em> it was important. The top search results generally explain <em>what</em> it is and <em>how</em> to use it, but handwave the <em>why</em> and treat it as yet-another-language-feature.</p>\n<p>Then I came across this statement in a <a href=\"https://blog.cleancoder.com/uncle-bob/2018/04/13/FPvsOO.html\">blog post</a> by Robert C. Martin:</p>\n<blockquote>\n<p>…the thing that truly differentiates OO programs from non-OO programs is polymorphism.</p>\n</blockquote>\n<p>Whoa! Now he didn’t mean that encapsulation and other “OOP concepts” were unimportant - his point was that they are achievable in “non-OOP” as well, but polymorphism was not.</p>\n<p>If polymorphism is such a defining aspect of OOP, could we build a stronger intuition for <em>why</em> it’s important?</p>\n<h2 id=\"what-is-polymorphism\" style=\"position:relative;\"><a href=\"#what-is-polymorphism\" aria-label=\"what is polymorphism permalink\" class=\"autolink-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is polymorphism?</h2>\n<p>Since polymorphism has different meanings depending on context<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>, let’s align on what I meant by “Polymorphism in OOP”. In the earlier blog post, Martin explains it as different objects being able to accept the same message, implementing their own behaviour. I’ll paraphase his example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">some_object.do_something()</code></pre></div>\n<p>We don’t actually know what <code class=\"language-text\">some_object</code> is! Nor does it actually matter. Many different implementations could replace <code class=\"language-text\">some_object</code>, and so long as they have the same interface (i.e. have the method <code class=\"language-text\">#do_something</code>), the program would still run.</p>\n<h2 id=\"why-use-polymorphism\" style=\"position:relative;\"><a href=\"#why-use-polymorphism\" aria-label=\"why use polymorphism permalink\" class=\"autolink-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why use polymorphism?</h2>\n<p>In another <a href=\"https://blog.cleancoder.com/uncle-bob/2014/11/24/FPvsOO.html\">blog post</a>, Martin says:</p>\n<blockquote>\n<p>There really is only one benefit to Polymorphism; but it’s a big one. It is the inversion of source code and run time dependencies.</p>\n</blockquote>\n<p>It wasn’t initially obvious to me what that meant, so let’s concretise this with an example: caching in a web framework like Rails. There are multiple options out there for caches - for example, Rails supports a <code class=\"language-text\">FileStore</code>, a <code class=\"language-text\">MemCacheStore</code> and a <code class=\"language-text\">RedisCacheStore</code>. For the sake of illustration, imagine that the caches all had their own interfaces:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">example_method</span></span>\n  <span class=\"token comment\"># do stuff</span>\n  <span class=\"token keyword\">if</span> Rails<span class=\"token punctuation\">.</span>cache<span class=\"token punctuation\">.</span>is_a<span class=\"token operator\">?</span> NaiveFileStore\n    data <span class=\"token operator\">=</span> Rails<span class=\"token punctuation\">.</span>cache<span class=\"token punctuation\">.</span>search_for<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">elsif</span> Rails<span class=\"token punctuation\">.</span>cache<span class=\"token punctuation\">.</span>is_a<span class=\"token operator\">?</span> NaiveRedisCacheStore\n    data <span class=\"token operator\">=</span> Rails<span class=\"token punctuation\">.</span>cache<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n  <span class=\"token comment\"># do more stuff</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>Above, our <code class=\"language-text\">example_method</code> has a direct dependency on <code class=\"language-text\">NaiveFileStore</code> and <code class=\"language-text\">NaiveRedisCacheStore</code>. If their interfaces change, or new kinds of store need to be supported, it will require changes in <code class=\"language-text\">example_method</code>.</p>\n<p>Earlier, Martin talked about an inversion of dependencies (the “D” in SOLID) - practically, this means  <code class=\"language-text\">example_method</code> and the different cache stores agree on an interface, and both depend on it. This makes all cache stores polymorphic! In Rails, all <a href=\"https://guides.rubyonrails.org/caching_with_rails.html#activesupport-cache-store\">cache stores</a> implement a <code class=\"language-text\">#fetch</code> method, so the above code becomes:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">example_method</span></span>\n  <span class=\"token comment\"># do stuff</span>\n  data <span class=\"token operator\">=</span> Rails<span class=\"token punctuation\">.</span>cache<span class=\"token punctuation\">.</span>fetch<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\"># do more stuff</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>The code in <code class=\"language-text\">example_method</code> is more concise now, but that’s a side benefit; what’s important is it’s shielded from knowing which cache store is used, and how the store works. It just knows that <em>some</em> cache store exists (<code class=\"language-text\">Rails.cache</code>), and the cache store has agreed to implement a <code class=\"language-text\">#fetch</code> method.</p>\n<p>We can visualise this “inversion” below - the arrows can be thought of as “dependency directions”:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 501px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a99ebb7855eee46e02e449256eb4b2af/55811/polymorphic.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.37837837837837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwklEQVQ4y42UiaoqQQxE+/+/wj9RxF0QBUVEwQX3fd+1LieXXAZxHi8QMtNLdSWp7pDJZIQXi0Vls1m1220tFguNx2NNJhO932/F2be5cLlcdL/f9Xw+LZ5OJx0OB4ur1Ur7/V6scWf8eDz+gX2ChsfjIRwwoi9i83Q61fV61XA4VK/XU7/ft39AIfAV8Hw+2wJnttlszAHnn3lY7nY7bbdbA4Th6/X6DtjtdjUajTQYDLRcLm3j7XazSVhwECDuHIDH1TFwGkxwmDgbUqY5pMuBNIlIo6htbA0ZiDpGOrCczWYGQJzP5xY5hNRjU9Y/jDrC1NPlECJjn0Tcg0sh2pxojT5158ziLKTTaeXzeVWrVeVyORN3qVSyVJEN9SJdvqNS+caaGNbrtTWC5nhTvDGAuVyQktcLzbIGMPaREXPlcvm3htFmuH2mxhqXEeB+wzqdjnUfSyaTCtwA1yFdhDHMaEiz2VQqlVKtVrMNzMMWYEBh5xcClvV6/Tdlvx1MkCKR8UajYY9Gq9UyMIRPqrB3QNcwgBAI1MELyqAX3m+EF5zN/nj4tx9CA8mIZob/fZaiBkuUUSgUTBl4pVJRIpHQD9CCzg1WqwTwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"polymorphic.png\"\n        title=\"polymorphic.png\"\n        src=\"/static/a99ebb7855eee46e02e449256eb4b2af/55811/polymorphic.png\"\n        srcset=\"/static/a99ebb7855eee46e02e449256eb4b2af/12f09/polymorphic.png 148w,\n/static/a99ebb7855eee46e02e449256eb4b2af/e4a3f/polymorphic.png 295w,\n/static/a99ebb7855eee46e02e449256eb4b2af/55811/polymorphic.png 501w\"\n        sizes=\"(max-width: 501px) 100vw, 501px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Martin describes this as a “plugin architecture”:</p>\n<blockquote>\n<p>This inversion allows the called module to act like a plugin. Indeed, this is how all plugins work…\nPlugin architectures are very robust because stable high value business rules can be kept from depending upon volatile low value modules such as user interfaces and databases.</p>\n</blockquote>\n<p>With the new setup, the polymorphic cache stores can be swapped for each other without changing the code in <code class=\"language-text\">example_method</code>. New kinds of cache stores can also be supported by creating classes that implement  <code class=\"language-text\">#fetch</code> and other methods as specified by <a href=\"https://guides.rubyonrails.org/caching_with_rails.html#activesupport-cache-store\">ActiveSupport::Cache::Store</a>.</p>\n<p>In short, polymorphism makes it easier to extend or change aspects of our programs, without a rippling of changes throughout the entire program. (How do we determine the “aspects” to split our programs by? A good read would be <a href=\"https://www.wasabigeek.com/blog/what-does-a-1972-paper-have-to-do-with-the-single-responsibility-principle/\">Parnas’ classic 1972 paper</a>.)</p>\n<h2 id=\"afterword\" style=\"position:relative;\"><a href=\"#afterword\" aria-label=\"afterword permalink\" class=\"autolink-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Afterword</h2>\n<p>While our cache example does rely on inheritance to make the polymorphic group explicit, inheritance is not a prerequisite. For example, each cache could be a completely unrelated class, and it still would work in Ruby as long as they had a <code class=\"language-text\">#fetch</code> method (this is also called <a href=\"https://en.wikipedia.org/wiki/Subtyping#Relationship_with_inheritance\">“duck-typing”</a>).</p>\n<p>You may have spotted that Martin talks about inversion of “source code” in addition to runtime dependencies. I understand this has greater implications in compiled programs, but am not familiar enough to expound on it. Do leave a comment if you have an example!</p>\n<p>There are many other neat examples relating to polymorphism. Here’s some I thought of:</p>\n<ul>\n<li>Martin Fowler’s <a href=\"https://martinfowler.com/books/refactoring.html\">refactoring</a> book has a “Replace Conditional with Polymorphism” refactoring, which I think was neatly illustrated in this <a href=\"https://youtu.be/8bZh5LMaSmE\">Sandi Metz talk</a>.</li>\n<li>Many <a href=\"https://refactoring.guru/design-patterns/behavioral-patterns\">Behavioural Design Patterns</a> rely on polymorphism, for example the Strategy, Command, Visitor etc.</li>\n<li>The <a href=\"https://refactoring.guru/introduce-null-object\">NullObject</a> is a neat way to support a null value or no-ops when your code relies on a Polymorphic interface. (Note that while Rails has a <a href=\"https://guides.rubyonrails.org/caching_with_rails.html#activesupport-cache-nullstore\">NullCache</a>, it doesn’t solve the same issue that the pattern is meant to.)</li>\n<li>Ruby-specific example of a “Plugin Architecture”: Rubocop allows you to add your own <a href=\"https://docs.rubocop.org/rubocop/1.26/extensions.html#writing-your-own-cops\">custom cops</a> without changing the library’s source code, because all cops are polymorphic!</li>\n</ul>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">The definition I used for polymorphism is actually somewhat narrow, but seemed like a relatively common understanding in the context of OOP. The <a href=\"https://en.m.wikipedia.org/wiki/Polymorphism_(computer_science)\">Wikipedia article</a> on polymorphism shows a lot more breadth in the topic, and I think what is described above is known as <a href=\"https://en.wikipedia.org/wiki/Dynamic_dispatch\">single, dynamic dispatch</a>. There’s some really good discussion on this in the <a href=\"https://www.reddit.com/r/ruby/comments/tooyby/why_use_polymorphism_in_oop_blog_post/\">Reddit thread</a> for this post.<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>","frontmatter":{"title":"Why use Polymorphism in OOP?","date":"March 20, 2022","description":"Polymorphism in Object-Oriented Programming, while abstract, is still somewhat easy to understand. Why we should use it, though, is less obvious. Let's investigate polymorphism's benefits!"}},"allMarkdownRemark":{"edges":[{"node":{"excerpt":"If you’re trying to get more productive at writing or content creation (especially long-form), I highly recommend checking out How to take…","fields":{"slug":"/blog/zettelkasten-and-how-to-take-smart-notes/"},"frontmatter":{"date":"April 16, 2022","title":"Zettelkasten from \"How to take Smart Notes\"","description":"A review and summary of 'How to take Smart Notes' and the Zettelkasten process described within. I think of it as purposeful note-taking, used to generate ideas for writing or content creation."}}},{"node":{"excerpt":"When I first came across the concept of Polymorphism in Object-Oriented Programming (OOP), it wasn’t obvious to me why it was important. The…","fields":{"slug":"/blog/why-is-polymorphism-important/"},"frontmatter":{"date":"March 20, 2022","title":"Why use Polymorphism in OOP?","description":"Polymorphism in Object-Oriented Programming, while abstract, is still somewhat easy to understand. Why we should use it, though, is less obvious. Let's investigate polymorphism's benefits!"}}},{"node":{"excerpt":"”A class should only have one reason to change” is a mantra that Object-Oriented advocates have chanted for years. Dubbed the “Single…","fields":{"slug":"/blog/what-does-a-1972-paper-have-to-do-with-the-single-responsibility-principle/"},"frontmatter":{"date":"February 28, 2022","title":"A 1972 paper and the Single Responsibility Principle","description":"While trying to explain the Single Responsibility Principle, it's originator calls attention to the paper 'On the Criteria To Be Used in Decomposing Systems into Modules'. Why was this paper so significant? Let's find out!"}}}]}},"pageContext":{"slug":"/blog/why-is-polymorphism-important/","previous":{"fields":{"slug":"/blog/what-does-a-1972-paper-have-to-do-with-the-single-responsibility-principle/"},"frontmatter":{"title":"A 1972 paper and the Single Responsibility Principle","tags":["object-oriented","single-responsibility-principle"]}},"next":{"fields":{"slug":"/blog/zettelkasten-and-how-to-take-smart-notes/"},"frontmatter":{"title":"Zettelkasten from \"How to take Smart Notes\"","tags":["knowledge-management"]}},"relatedPosts":[{"node":{"fields":{"slug":"/blog/what-does-a-1972-paper-have-to-do-with-the-single-responsibility-principle/"},"frontmatter":{"title":"A 1972 paper and the Single Responsibility Principle","tags":["object-oriented","single-responsibility-principle"]}}}]}},
    "staticQueryHashes": ["2744205926","2841359383"]}