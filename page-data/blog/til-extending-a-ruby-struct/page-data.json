{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/blog/til-extending-a-ruby-struct/",
    "result": {"data":{"site":{"siteMetadata":{"title":"wasabigeek"}},"markdownRemark":{"id":"b7743504-6199-57fb-af2a-a4e17f852fee","excerpt":"Last week I had a head-scratching moment looking at the following code (from the google-api-ruby-client): My initial confusion stemmed from the assumption thatâ€¦","html":"<p>Last week I had a head-scratching moment looking at the following code (from the <a href=\"https://github.com/googleapis/google-api-ruby-client/blob/google-apis-core/v0.4.1/google-apis-core/lib/google/apis/options.rb\">google-api-ruby-client</a>):</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">ClientOptions <span class=\"token operator\">=</span> <span class=\"token class-name\">Struct</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span>\n    <span class=\"token symbol\">:application_name</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">:application_version</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">:proxy_url</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">:open_timeout_sec</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">:read_timeout_sec</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">:send_timeout_sec</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">:log_http_requests</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">:transparent_gzip_decompression</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ...</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ClientOptions</span>\n    <span class=\"token comment\"># ...</span>\n    <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">default</span></span>\n    <span class=\"token variable\">@options</span> <span class=\"token operator\">||=</span> <span class=\"token class-name\">ClientOptions</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span>\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>My initial confusion stemmed from the assumption that the first <code class=\"language-text\">ClientOptions</code> declaration returned a regular object. A helpful colleague explained to me that <code class=\"language-text\">Struct.new</code> actually returns a subclass of <a href=\"https://ruby-doc.org/core-3.0.2/Struct.html\">Struct</a>. That meant the second <code class=\"language-text\">class ClientOptions</code> declaration was actually <em>re-opening</em> the class to add a method, not to declare a new class.</p>\n<p>Why would one want to do this? Well, one would get all the methods of a regular Struct (e.g. accessors, iterators) <s>for free</s> at the cost of the inheritance hierarchy. This could be useful for <a href=\"https://martinfowler.com/bliki/ValueObject.html\">ValueObjects</a>.</p>","frontmatter":{"title":"TIL: Extending a Ruby Struct","date":"November 07, 2021","description":"a.k.a. well duh, of course a Struct returns a class."}}},"pageContext":{"slug":"/blog/til-extending-a-ruby-struct/","previous":{"fields":{"slug":"/blog/meta-postgres-what-constraints-does-a-table-have/"},"frontmatter":{"title":"Meta-Postgres: What constraints does a table have?"}},"next":{"fields":{"slug":"/blog/my-learning-workflow-for-2022/"},"frontmatter":{"title":"My Learning Workflow for 2022"}}}},
    "staticQueryHashes": ["2744205926","2841359383"]}